<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Supplier Portal ‚Äî ProKit Studio</title>
<link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=DM+Sans:wght@300;400;500;600&family=DM+Mono:wght@400;500&display=swap" rel="stylesheet">
<style>
  :root {
    --black: #0a0a0a;
    --white: #f5f3ee;
    --cream: #f0ece3;
    --green: #1a3c2b;
    --grass: #2d6a4f;
    --gold: #c9a84c;
    --gold-light: #e8c96d;
    --gold-dim: rgba(201,168,76,0.1);
    --light-gray: #e2ddd6;
    --mid-gray: #c8c4bc;
    --text: #1a1a1a;
    --text2: #555;
    --text3: #888;
    --red: #c0392b;
    --red-dim: rgba(192,57,43,0.08);
  }
  * { margin:0; padding:0; box-sizing:border-box; }
  html { scroll-behavior:smooth; }
  body { font-family:'DM Sans',sans-serif; background:var(--white); color:var(--text); min-height:100vh; }

  /* LOGIN */
  .login-screen { min-height:100vh; display:flex; flex-direction:column; align-items:center; justify-content:center; padding:2rem; background:var(--white); }
  .login-logo { font-family:'Bebas Neue',sans-serif; font-size:2rem; letter-spacing:0.08em; color:var(--green); }
  .login-logo span { color:var(--gold); }
  .login-badge { font-family:'DM Mono',monospace; font-size:0.65rem; letter-spacing:0.2em; text-transform:uppercase; color:var(--gold); background:var(--gold-dim); border:1px solid rgba(201,168,76,0.25); padding:0.25rem 0.7rem; border-radius:3px; margin:0.5rem 0 2.5rem; display:inline-block; }
  .login-box { background:var(--cream); border:1px solid var(--light-gray); border-radius:8px; padding:2.5rem; width:100%; max-width:480px; box-shadow:0 4px 24px rgba(0,0,0,0.06); }
  .login-title { font-family:'Bebas Neue',sans-serif; font-size:2.2rem; color:var(--green); margin-bottom:0.4rem; }
  .login-desc { font-size:0.88rem; color:var(--text2); margin-bottom:2rem; line-height:1.6; }
  .login-divider { display:flex; align-items:center; gap:1rem; margin:1.5rem 0; }
  .login-divider::before,.login-divider::after { content:''; flex:1; height:1px; background:var(--light-gray); }
  .login-divider span { font-size:0.7rem; color:var(--text3); font-family:'DM Mono',monospace; text-transform:uppercase; letter-spacing:0.1em; white-space:nowrap; }
  .existing-supplier-btn { display:flex; align-items:center; justify-content:space-between; padding:0.9rem 1rem; background:white; border:1px solid var(--light-gray); border-radius:6px; cursor:pointer; transition:all 0.2s; width:100%; margin-bottom:0.5rem; }
  .existing-supplier-btn:hover { border-color:var(--green); background:rgba(26,60,43,0.02); }
  .existing-supplier-name { font-weight:600; font-size:0.92rem; color:var(--green); display:block; }
  .existing-supplier-id { font-family:'DM Mono',monospace; font-size:0.68rem; color:var(--text3); display:block; margin-top:0.1rem; }
  .existing-supplier-arrow { color:var(--text3); }
  .no-suppliers { font-size:0.82rem; color:var(--text3); text-align:center; padding:1rem 0; }

  /* NAV */
  nav { display:flex; align-items:center; justify-content:space-between; padding:1rem 2.5rem; border-bottom:1px solid var(--light-gray); background:rgba(245,243,238,0.95); backdrop-filter:blur(12px); position:sticky; top:0; z-index:100; }
  .nav-left { display:flex; align-items:center; gap:1rem; }
  .logo { font-family:'Bebas Neue',sans-serif; font-size:1.4rem; letter-spacing:0.08em; color:var(--green); text-decoration:none; }
  .logo span { color:var(--gold); }
  .portal-badge { font-family:'DM Mono',monospace; font-size:0.6rem; letter-spacing:0.15em; text-transform:uppercase; background:var(--gold-dim); color:var(--gold); border:1px solid rgba(201,168,76,0.3); padding:0.22rem 0.6rem; border-radius:3px; }
  .nav-right { display:flex; align-items:center; gap:0.8rem; }
  .supplier-switcher { display:flex; align-items:center; gap:0.5rem; padding:0.4rem 0.9rem; background:var(--cream); border:1px solid var(--light-gray); border-radius:4px; cursor:pointer; transition:all 0.2s; font-size:0.8rem; color:var(--text2); }
  .supplier-switcher:hover { border-color:var(--green); color:var(--green); }
  .supplier-switcher strong { color:var(--green); font-weight:600; }
  .btn-preview { background:var(--grass); color:white; padding:0.5rem 1.1rem; font-size:0.78rem; font-weight:600; letter-spacing:0.05em; text-transform:uppercase; border:none; border-radius:3px; cursor:pointer; text-decoration:none; transition:background 0.2s; display:inline-flex; align-items:center; gap:0.4rem; }
  .btn-preview:hover { background:var(--green); }
  .btn-save-nav { background:var(--green); color:white; padding:0.5rem 1.1rem; font-size:0.78rem; font-weight:700; letter-spacing:0.05em; text-transform:uppercase; border:none; border-radius:3px; cursor:pointer; transition:background 0.2s; }
  .btn-save-nav:hover { background:var(--grass); }

  /* LAYOUT */
  .portal { display:none; }
  .portal.active { display:block; }
  .layout { display:grid; grid-template-columns:220px 1fr; min-height:calc(100vh - 57px); }

  /* SIDEBAR */
  .sidebar { background:var(--cream); border-right:1px solid var(--light-gray); padding:1.5rem 0; position:sticky; top:57px; height:calc(100vh - 57px); overflow-y:auto; }
  .sidebar-section { padding:0 0.8rem 1rem; }
  .sidebar-label { font-family:'DM Mono',monospace; font-size:0.58rem; letter-spacing:0.18em; text-transform:uppercase; color:var(--text3); padding:0 0.4rem; margin-bottom:0.5rem; display:block; }
  .sidebar-item { display:flex; align-items:center; gap:0.7rem; padding:0.6rem 0.8rem; border-radius:4px; cursor:pointer; font-size:0.85rem; color:var(--text2); transition:all 0.15s; border:1px solid transparent; margin-bottom:0.1rem; }
  .sidebar-item:hover { background:white; color:var(--text); }
  .sidebar-item.active { background:white; color:var(--green); border-color:var(--light-gray); font-weight:600; box-shadow:0 1px 4px rgba(0,0,0,0.05); }
  .sidebar-icon { font-size:1rem; width:20px; text-align:center; }
  .sidebar-divider { border:none; border-top:1px solid var(--light-gray); margin:0.5rem 0.8rem 1rem; }

  /* MAIN */
  .main { padding:2.5rem 3rem; }
  .page-header { margin-bottom:2rem; padding-bottom:1.5rem; border-bottom:1px solid var(--light-gray); }
  .page-eyebrow { font-family:'DM Mono',monospace; font-size:0.62rem; letter-spacing:0.2em; text-transform:uppercase; color:var(--gold); margin-bottom:0.5rem; }
  .page-title { font-family:'Bebas Neue',sans-serif; font-size:2.5rem; letter-spacing:0.03em; color:var(--green); line-height:1; }
  .page-desc { font-size:0.88rem; color:var(--text2); margin-top:0.5rem; line-height:1.6; max-width:600px; }
  .supplier-id-display { font-family:'DM Mono',monospace; font-size:0.72rem; background:var(--cream); border:1px solid var(--light-gray); padding:0.3rem 0.8rem; border-radius:20px; color:var(--text3); display:inline-block; margin-top:0.6rem; }
  .supplier-id-display strong { color:var(--green); }

  /* TABS */
  .tab-content { display:none; }
  .tab-content.active { display:block; }

  /* CARDS */
  .card { background:var(--cream); border:1px solid var(--light-gray); border-radius:6px; padding:1.8rem; margin-bottom:1.2rem; }
  .card-header { display:flex; align-items:flex-start; justify-content:space-between; margin-bottom:1.4rem; }
  .card-title { font-size:0.95rem; font-weight:700; color:var(--text); display:flex; align-items:center; gap:0.5rem; }
  .card-subtitle { font-size:0.78rem; color:var(--text3); margin-top:0.25rem; }

  /* FORM */
  .form-row { display:grid; grid-template-columns:1fr 1fr; gap:1rem; margin-bottom:1rem; }
  .form-row.single { grid-template-columns:1fr; }
  .form-row.triple { grid-template-columns:1fr 1fr 1fr; }
  .form-group { display:flex; flex-direction:column; gap:0.4rem; }
  .form-label { font-family:'DM Mono',monospace; font-size:0.62rem; letter-spacing:0.12em; text-transform:uppercase; color:var(--text3); }
  .form-input { background:white; border:1px solid var(--light-gray); color:var(--text); font-family:'DM Sans',sans-serif; font-size:0.88rem; padding:0.65rem 0.85rem; border-radius:4px; transition:border-color 0.2s; width:100%; }
  .form-input:focus { outline:none; border-color:var(--green); box-shadow:0 0 0 3px rgba(26,60,43,0.08); }
  .form-input::placeholder { color:var(--mid-gray); }
  .form-select { background:white; border:1px solid var(--light-gray); color:var(--text); font-family:'DM Sans',sans-serif; font-size:0.88rem; padding:0.65rem 0.85rem; border-radius:4px; cursor:pointer; width:100%; }
  .form-select:focus { outline:none; border-color:var(--green); }
  .form-hint { font-size:0.72rem; color:var(--text3); line-height:1.5; }

  /* BRANDING PREVIEW */
  .branding-preview { background:white; border:1px solid var(--light-gray); border-radius:6px; padding:1.5rem; display:flex; align-items:center; gap:1.5rem; }
  .brand-logo-preview { width:72px; height:72px; border-radius:6px; background:var(--cream); border:2px dashed var(--mid-gray); display:flex; align-items:center; justify-content:center; font-size:2rem; flex-shrink:0; overflow:hidden; }
  .brand-logo-preview img { width:100%; height:100%; object-fit:contain; }
  .brand-name-preview { font-family:'Bebas Neue',sans-serif; font-size:1.7rem; letter-spacing:0.05em; color:var(--green); }
  .brand-tagline-preview { font-size:0.82rem; color:var(--text3); margin-top:0.2rem; }
  .brand-accent-preview { display:flex; align-items:center; gap:0.5rem; margin-top:0.7rem; }
  .accent-dot { width:16px; height:16px; border-radius:50%; border:1px solid rgba(0,0,0,0.1); }
  .accent-label { font-size:0.7rem; font-family:'DM Mono',monospace; color:var(--text3); }

  /* COLOR PALETTE */
  .palette-grid { display:flex; flex-wrap:wrap; gap:0.6rem; }
  .palette-swatch { position:relative; width:46px; height:46px; border-radius:8px; border:2px solid transparent; cursor:pointer; transition:transform 0.15s, box-shadow 0.15s; box-shadow:0 1px 4px rgba(0,0,0,0.1); }
  .palette-swatch:hover { transform:scale(1.12); box-shadow:0 4px 12px rgba(0,0,0,0.15); }
  .swatch-remove { position:absolute; top:-6px; right:-6px; width:17px; height:17px; background:var(--red); border-radius:50%; color:white; font-size:0.65rem; display:none; align-items:center; justify-content:center; cursor:pointer; font-weight:bold; }
  .palette-swatch:hover .swatch-remove { display:flex; }
  .add-color-btn { width:46px; height:46px; border-radius:8px; border:2px dashed var(--mid-gray); background:white; color:var(--mid-gray); font-size:1.5rem; cursor:pointer; display:flex; align-items:center; justify-content:center; transition:all 0.2s; }
  .add-color-btn:hover { border-color:var(--green); color:var(--green); }

  /* COLOR MODAL */
  .color-modal { position:fixed; inset:0; background:rgba(0,0,0,0.35); backdrop-filter:blur(4px); z-index:500; display:none; align-items:center; justify-content:center; }
  .color-modal.open { display:flex; }
  .color-modal-box { background:white; border:1px solid var(--light-gray); border-radius:10px; padding:2rem; width:340px; box-shadow:0 20px 60px rgba(0,0,0,0.12); }
  .color-modal-title { font-weight:700; font-size:1rem; margin-bottom:1.2rem; color:var(--text); }
  .color-preview-large { width:100%; height:64px; border-radius:6px; margin-bottom:1rem; border:1px solid var(--light-gray); }

  /* PRODUCT TABLE */
  .product-table { width:100%; border-collapse:collapse; }
  .product-table th { font-family:'DM Mono',monospace; font-size:0.6rem; letter-spacing:0.15em; text-transform:uppercase; color:var(--text3); text-align:left; padding:0.7rem 1rem; border-bottom:2px solid var(--light-gray); background:var(--cream); }
  .product-table td { padding:0.85rem 1rem; border-bottom:1px solid var(--light-gray); font-size:0.85rem; vertical-align:middle; background:white; }
  .product-table tr:last-child td { border-bottom:none; }
  .product-table tr:hover td { background:#faf9f6; }
  .product-toggle { position:relative; display:inline-block; width:38px; height:20px; }
  .product-toggle input { display:none; }
  .toggle-slider { position:absolute; inset:0; background:var(--mid-gray); border-radius:20px; cursor:pointer; transition:background 0.2s; }
  .toggle-slider::before { content:''; position:absolute; width:14px; height:14px; left:3px; top:3px; background:white; border-radius:50%; transition:transform 0.2s; box-shadow:0 1px 3px rgba(0,0,0,0.15); }
  .product-toggle input:checked + .toggle-slider { background:var(--grass); }
  .product-toggle input:checked + .toggle-slider::before { transform:translateX(18px); }
  .product-tag { display:inline-block; font-size:0.65rem; font-family:'DM Mono',monospace; padding:0.18rem 0.55rem; border-radius:3px; }
  .tag-active { background:rgba(45,106,79,0.1); color:var(--grass); border:1px solid rgba(45,106,79,0.2); }
  .tag-inactive { background:var(--cream); color:var(--text3); border:1px solid var(--light-gray); }
  .sku-input { background:var(--cream); border:1px solid var(--light-gray); color:var(--text); font-size:0.78rem; padding:0.3rem 0.5rem; border-radius:3px; width:85px; font-family:'DM Mono',monospace; }
  .sku-input:focus { outline:none; border-color:var(--green); background:white; }
  .btn-danger { background:transparent; color:var(--red); font-size:0.74rem; border:1px solid rgba(192,57,43,0.2); border-radius:3px; padding:0.3rem 0.7rem; cursor:pointer; transition:all 0.2s; }
  .btn-danger:hover { background:var(--red-dim); border-color:var(--red); }

  /* ADD PRODUCT */
  .add-product-panel { background:var(--cream); border:2px dashed var(--mid-gray); border-radius:6px; padding:1.5rem; margin-top:1rem; }
  .add-product-title { font-size:0.88rem; font-weight:700; margin-bottom:1rem; color:var(--green); }

  /* PATCHES */
  .patch-list { display:flex; flex-direction:column; gap:0.6rem; }
  .patch-item { background:white; border:1px solid var(--light-gray); border-radius:6px; padding:0.9rem 1rem; display:flex; align-items:center; gap:1rem; }
  .patch-icon-preview { font-size:1.5rem; width:36px; text-align:center; flex-shrink:0; }
  .patch-info { flex:1; }
  .patch-name { font-weight:600; font-size:0.88rem; }
  .patch-desc { font-size:0.75rem; color:var(--text3); margin-top:0.1rem; }

  /* MINIMUMS */
  .minimums-grid { display:grid; grid-template-columns:repeat(3,1fr); gap:0.8rem; }
  .minimum-card { background:white; border:1px solid var(--light-gray); border-radius:6px; padding:1.2rem; }
  .minimum-product { font-size:0.7rem; font-family:'DM Mono',monospace; color:var(--text3); text-transform:uppercase; letter-spacing:0.1em; margin-bottom:0.5rem; }
  .minimum-input { background:var(--cream); border:1px solid var(--light-gray); color:var(--green); font-size:1.7rem; font-weight:700; font-family:'Bebas Neue',sans-serif; padding:0.4rem; border-radius:4px; width:100%; text-align:center; }
  .minimum-input:focus { outline:none; border-color:var(--green); background:white; }
  .minimum-unit { font-size:0.68rem; color:var(--text3); text-align:center; margin-top:0.3rem; font-family:'DM Mono',monospace; }

  /* BUTTONS */
  .btn-primary { background:var(--green); color:white; font-size:0.82rem; font-weight:700; letter-spacing:0.06em; text-transform:uppercase; padding:0.75rem 1.5rem; border:none; border-radius:4px; cursor:pointer; transition:background 0.2s, transform 0.15s; }
  .btn-primary:hover { background:var(--grass); transform:translateY(-1px); }
  .btn-secondary { background:transparent; color:var(--text2); font-size:0.82rem; font-weight:600; letter-spacing:0.05em; text-transform:uppercase; padding:0.75rem 1.2rem; border:1px solid var(--light-gray); border-radius:4px; cursor:pointer; transition:all 0.2s; }
  .btn-secondary:hover { border-color:var(--green); color:var(--green); }
  .btn-row { display:flex; gap:0.7rem; align-items:center; margin-top:1.2rem; }

  /* STATS */
  .stats-row { display:grid; grid-template-columns:repeat(4,1fr); gap:1rem; margin-bottom:2rem; }
  .stat-card { background:var(--cream); border:1px solid var(--light-gray); border-radius:6px; padding:1.2rem; border-top:3px solid var(--gold); }
  .stat-value { font-family:'Bebas Neue',sans-serif; font-size:2.8rem; color:var(--green); line-height:1; }
  .stat-label { font-size:0.7rem; color:var(--text3); font-family:'DM Mono',monospace; text-transform:uppercase; letter-spacing:0.1em; margin-top:0.3rem; }

  /* EMBED */
  .embed-box { background:var(--black); border-radius:6px; padding:1.2rem 1.4rem; font-family:'DM Mono',monospace; font-size:0.78rem; color:#7ec8a0; line-height:1.9; overflow-x:auto; white-space:pre; margin-bottom:0.8rem; }
  .copy-btn { background:var(--cream); border:1px solid var(--light-gray); color:var(--text2); font-size:0.75rem; padding:0.4rem 0.9rem; border-radius:3px; cursor:pointer; transition:all 0.2s; }
  .copy-btn:hover { border-color:var(--green); color:var(--green); }

  /* ALERT */
  .alert { background:var(--gold-dim); border:1px solid rgba(201,168,76,0.25); border-radius:4px; padding:0.9rem 1rem; font-size:0.85rem; color:var(--text); margin-bottom:1.2rem; display:flex; align-items:flex-start; gap:0.7rem; line-height:1.6; }
  .alert-green { background:rgba(26,60,43,0.06); border-color:rgba(26,60,43,0.2); }

  /* TOAST */
  .toast { position:fixed; bottom:2rem; left:50%; transform:translateX(-50%) translateY(60px); opacity:0; background:var(--grass); color:white; padding:0.8rem 1.5rem; border-radius:4px; font-size:0.85rem; font-weight:600; transition:all 0.3s; z-index:999; white-space:nowrap; box-shadow:0 4px 16px rgba(0,0,0,0.15); }
  .toast.show { transform:translateX(-50%) translateY(0); opacity:1; }
</style>
</head>
<body>

<!-- COLOR MODAL -->
<div class="color-modal" id="color-modal">
  <div class="color-modal-box">
    <div class="color-modal-title">Add Color to Palette</div>
    <div class="color-preview-large" id="color-preview-large" style="background:#1a3c2b"></div>
    <div class="form-row">
      <div class="form-group">
        <label class="form-label">Color Name</label>
        <input class="form-input" id="new-color-name" placeholder="e.g. Forest Green">
      </div>
      <div class="form-group">
        <label class="form-label">Hex Code</label>
        <input class="form-input" id="new-color-hex" placeholder="#1a3c2b" maxlength="7">
      </div>
    </div>
    <div class="form-group" style="margin-bottom:1rem">
      <label class="form-label">Color Picker</label>
      <input type="color" id="new-color-picker" value="#1a3c2b" style="width:100%;height:44px;border:1px solid var(--light-gray);border-radius:4px;cursor:pointer;padding:3px;background:white;">
    </div>
    <div class="btn-row">
      <button class="btn-primary" onclick="confirmAddColor()">Add Color</button>
      <button class="btn-secondary" onclick="closeColorModal()">Cancel</button>
    </div>
  </div>
</div>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê LOGIN SCREEN ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<div id="login-screen" style="min-height:100vh;display:flex;flex-direction:column;align-items:center;justify-content:center;padding:2rem">
  <div class="login-logo">ProKit<span>Studio</span></div>
  <span class="login-badge">Supplier Portal</span>
  <div class="login-box">
    <div class="login-title">Supplier Login</div>
    <div class="login-desc">Each supplier gets their own catalog and a unique configurator link. Create a new account or select an existing one.</div>
    <div class="form-group" style="margin-bottom:0.8rem">
      <label class="form-label">Company Name</label>
      <input class="form-input" id="login-company-name" placeholder="e.g. Richardson Sports or Peter Millar">
    </div>
    <div class="form-group" style="margin-bottom:0.5rem">
      <label class="form-label">Supplier ID <span style="font-weight:400;text-transform:none;letter-spacing:0">(lowercase, no spaces)</span></label>
      <input class="form-input" id="login-supplier-id" placeholder="e.g. richardson or petermillar" style="font-family:'DM Mono',monospace">
    </div>
    <div class="form-hint" style="margin-bottom:1.2rem">Your configurator link will be: <code style="background:var(--cream);padding:0.1rem 0.4rem;border-radius:3px;font-family:'DM Mono',monospace">configure.html?supplier=<strong id="login-id-preview">yourID</strong></code></div>
    <button class="btn-primary" style="width:100%;padding:0.9rem" onclick="loginOrCreate()">Enter Portal ‚Üí</button>
    <div class="login-divider"><span>or open existing account</span></div>
    <div id="existing-suppliers-list"><div class="no-suppliers">No accounts saved yet ‚Äî create one above.</div></div>
  </div>
</div>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê MAIN PORTAL ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<div id="portal" class="portal">
  <nav>
    <div class="nav-left">
      <a class="logo" href="index.html">ProKit<span>Studio</span></a>
      <span class="portal-badge">Supplier Portal</span>
    </div>
    <div class="nav-right">
      <div class="supplier-switcher" onclick="goToLogin()">‚áÑ <strong id="nav-supplier-name">‚Äî</strong> <span style="color:var(--text3);font-size:0.75rem">Switch</span></div>
      <a class="btn-preview" id="nav-preview-link" href="configure.html" target="_blank">Preview Configurator ‚Üí</a>
      <button class="btn-save-nav" onclick="saveAll()">Save Changes</button>
    </div>
  </nav>

  <div class="layout">
    <aside class="sidebar">
      <div class="sidebar-section">
        <span class="sidebar-label">Setup</span>
        <div class="sidebar-item active" id="sb-branding" onclick="switchTab('branding')"><span class="sidebar-icon">üè∑Ô∏è</span> Branding</div>
        <div class="sidebar-item" id="sb-catalog" onclick="switchTab('catalog')"><span class="sidebar-icon">üì¶</span> Product Catalog</div>
        <div class="sidebar-item" id="sb-colors" onclick="switchTab('colors')"><span class="sidebar-icon">üé®</span> Colors</div>
        <div class="sidebar-item" id="sb-patches" onclick="switchTab('patches')"><span class="sidebar-icon">üñºÔ∏è</span> Logo & Patches</div>
        <div class="sidebar-item" id="sb-minimums" onclick="switchTab('minimums')"><span class="sidebar-icon">üìã</span> Order Minimums</div>
      </div>
      <hr class="sidebar-divider">
      <div class="sidebar-section">
        <span class="sidebar-label">Publish</span>
        <div class="sidebar-item" id="sb-embed" onclick="switchTab('embed')"><span class="sidebar-icon">üîó</span> Embed & Share</div>
      </div>
    </aside>

    <main class="main">

      <!-- BRANDING -->
      <div class="tab-content active" id="tab-branding">
        <div class="page-header">
          <div class="page-eyebrow">Step 1 ‚Äî Branding</div>
          <div class="page-title">Your Identity</div>
          <div class="page-desc">How your configurator looks to customers. Set your company name, brand colors, and logo.</div>
          <div class="supplier-id-display">Supplier ID: <strong id="display-supplier-id">‚Äî</strong></div>
        </div>
        <div class="card">
          <div class="card-header"><div><div class="card-title">üè¢ Company Info</div><div class="card-subtitle">Appears in the configurator header and order receipts</div></div></div>
          <div class="form-row">
            <div class="form-group"><label class="form-label">Company Name</label><input class="form-input" id="brand-name" placeholder="e.g. Richardson Sports" oninput="livePreview()"></div>
            <div class="form-group"><label class="form-label">Tagline</label><input class="form-input" id="brand-tagline" placeholder="e.g. Premium Custom Headwear Since 1970" oninput="livePreview()"></div>
          </div>
          <div class="form-row">
            <div class="form-group">
              <label class="form-label">Primary Color</label>
              <div style="display:flex;gap:0.5rem;align-items:center">
                <input type="color" id="brand-primary-color" value="#1a3c2b" oninput="syncHex('brand-primary-color','brand-primary-hex');livePreview()" style="width:44px;height:38px;border:1px solid var(--light-gray);border-radius:4px;cursor:pointer;padding:2px;background:white;flex-shrink:0">
                <input class="form-input" id="brand-primary-hex" placeholder="#1a3c2b" oninput="syncPicker('brand-primary-color','brand-primary-hex');livePreview()">
              </div>
              <span class="form-hint">Used for buttons and headers in your configurator</span>
            </div>
            <div class="form-group">
              <label class="form-label">Accent Color</label>
              <div style="display:flex;gap:0.5rem;align-items:center">
                <input type="color" id="brand-accent-color" value="#c9a84c" oninput="syncHex('brand-accent-color','brand-accent-hex');livePreview()" style="width:44px;height:38px;border:1px solid var(--light-gray);border-radius:4px;cursor:pointer;padding:2px;background:white;flex-shrink:0">
                <input class="form-input" id="brand-accent-hex" placeholder="#c9a84c" oninput="syncPicker('brand-accent-color','brand-accent-hex');livePreview()">
              </div>
              <span class="form-hint">Highlights and active selections</span>
            </div>
          </div>
          <div class="form-row single">
            <div class="form-group">
              <label class="form-label">Logo URL <span style="font-weight:400;text-transform:none;letter-spacing:0">(optional)</span></label>
              <input class="form-input" id="brand-logo-url" placeholder="https://yoursite.com/logo.png" oninput="livePreview()">
              <span class="form-hint">Paste a direct link to your logo. Leave blank to use your company name as text.</span>
            </div>
          </div>
        </div>
        <div class="card">
          <div class="card-header"><div class="card-title">üëÅÔ∏è Live Preview</div></div>
          <div class="branding-preview">
            <div class="brand-logo-preview" id="logo-preview-box">üè∑Ô∏è</div>
            <div>
              <div class="brand-name-preview" id="preview-brand-name">Your Company Name</div>
              <div class="brand-tagline-preview" id="preview-brand-tagline">Your tagline appears here</div>
              <div class="brand-accent-preview">
                <div class="accent-dot" id="preview-primary-dot" style="background:#1a3c2b"></div><span class="accent-label">Primary</span>
                <div class="accent-dot" id="preview-accent-dot" style="background:#c9a84c"></div><span class="accent-label">Accent</span>
              </div>
            </div>
          </div>
        </div>
        <div class="btn-row"><button class="btn-primary" onclick="saveAll();switchTab('catalog')">Save & Continue ‚Üí</button></div>
      </div>

      <!-- CATALOG -->
      <div class="tab-content" id="tab-catalog">
        <div class="page-header">
          <div class="page-eyebrow">Step 2 ‚Äî Catalog</div>
          <div class="page-title">Product Catalog</div>
          <div class="page-desc">Toggle the styles you carry. Only active styles appear in your customer configurator.</div>
        </div>
        <div class="alert"><span>üí°</span> Enable what you carry ‚Äî customers only see what's turned on here.</div>
        <div class="card" style="padding:0;overflow:hidden">
          <table class="product-table"><thead><tr><th>Active</th><th>Category</th><th>Style Name</th><th>SKU</th><th>Description</th><th></th></tr></thead><tbody id="product-tbody"></tbody></table>
        </div>
        <div class="add-product-panel">
          <div class="add-product-title">+ Add a Style</div>
          <div class="form-row triple">
            <div class="form-group"><label class="form-label">Category</label><select class="form-select" id="new-product-category"><option>Headwear</option><option>Polos</option><option>Quarter Zips</option><option>Belts</option><option>Bags</option><option>Outerwear</option></select></div>
            <div class="form-group"><label class="form-label">Style Name</label><input class="form-input" id="new-product-name" placeholder="e.g. Richardson 112"></div>
            <div class="form-group"><label class="form-label">SKU / Model #</label><input class="form-input" id="new-product-sku" placeholder="e.g. R112"></div>
          </div>
          <div class="form-row">
            <div class="form-group"><label class="form-label">Description</label><input class="form-input" id="new-product-desc" placeholder="e.g. 6-Panel Structured Snapback"></div>
            <div class="form-group"><label class="form-label">Snapback Strap?</label><select class="form-select" id="new-product-strap"><option value="true">Yes</option><option value="false">No</option></select></div>
          </div>
          <div class="btn-row"><button class="btn-primary" onclick="addProduct()">Add Style</button></div>
        </div>
        <div class="btn-row" style="margin-top:1.5rem"><button class="btn-primary" onclick="saveAll();switchTab('colors')">Save & Continue ‚Üí</button></div>
      </div>

      <!-- COLORS -->
      <div class="tab-content" id="tab-colors">
        <div class="page-header">
          <div class="page-eyebrow">Step 3 ‚Äî Colors</div>
          <div class="page-title">Color Palette</div>
          <div class="page-desc">Add every colorway you carry. Customers pick only from these ‚Äî no guessing, no mismatches.</div>
        </div>
        <div class="card">
          <div class="card-header"><div class="card-title">üé® Your Colorways</div><button class="btn-primary" style="font-size:0.75rem;padding:0.5rem 1rem" onclick="openColorModal()">+ Add Color</button></div>
          <div class="palette-grid" id="palette-grid"></div>
          <div class="form-hint" style="margin-top:0.8rem">Hover a swatch and click √ó to remove it.</div>
        </div>
        <div class="btn-row"><button class="btn-primary" onclick="saveAll();switchTab('patches')">Save & Continue ‚Üí</button></div>
      </div>

      <!-- PATCHES -->
      <div class="tab-content" id="tab-patches">
        <div class="page-header">
          <div class="page-eyebrow">Step 4 ‚Äî Decoration</div>
          <div class="page-title">Logo & Patch Options</div>
          <div class="page-desc">Enable the decoration methods you support. Customers only see what you turn on.</div>
        </div>
        <div class="card">
          <div class="card-header"><div class="card-title">üñºÔ∏è Decoration Methods</div></div>
          <div class="patch-list" id="patch-list"></div>
        </div>
        <div class="card">
          <div class="card-header"><div><div class="card-title">üìÅ File Requirements</div><div class="card-subtitle">Shown to customers when uploading artwork</div></div></div>
          <div class="form-row single"><div class="form-group"><label class="form-label">Accepted File Types</label><input class="form-input" id="accepted-files" value="AI, EPS, PDF, PNG (300dpi+)"></div></div>
          <div class="form-row single"><div class="form-group"><label class="form-label">Note to Customers</label><textarea class="form-input" id="logo-note" rows="3" style="resize:vertical">Please submit vector files (AI or EPS) for best embroidery results. PNG accepted at 300dpi minimum.</textarea></div></div>
        </div>
        <div class="btn-row"><button class="btn-primary" onclick="saveAll();switchTab('minimums')">Save & Continue ‚Üí</button></div>
      </div>

      <!-- MINIMUMS -->
      <div class="tab-content" id="tab-minimums">
        <div class="page-header">
          <div class="page-eyebrow">Step 5 ‚Äî Minimums</div>
          <div class="page-title">Order Minimums</div>
          <div class="page-desc">Set minimum order quantities per product category. Customers see this during checkout.</div>
        </div>
        <div class="card">
          <div class="card-header"><div class="card-title">üìã Minimum Order Quantities</div></div>
          <div class="minimums-grid" id="minimums-grid"></div>
        </div>
        <div class="card">
          <div class="card-header"><div class="card-title">‚è±Ô∏è Lead Times</div></div>
          <div class="form-row">
            <div class="form-group"><label class="form-label">Standard Lead Time</label><input class="form-input" id="lead-time" value="3-4 weeks"></div>
            <div class="form-group"><label class="form-label">Rush Lead Time</label><input class="form-input" id="rush-time" value="10-14 business days"></div>
          </div>
        </div>
        <div class="btn-row"><button class="btn-primary" onclick="saveAll();switchTab('embed')">Save & Get Embed Code ‚Üí</button></div>
      </div>

      <!-- EMBED -->
      <div class="tab-content" id="tab-embed">
        <div class="page-header">
          <div class="page-eyebrow">Publish</div>
          <div class="page-title">Embed & Share</div>
          <div class="page-desc">Your unique configurator link ‚Äî drop it on your website or share it directly with customers.</div>
        </div>
        <div class="stats-row">
          <div class="stat-card"><div class="stat-value" id="stat-products">0</div><div class="stat-label">Active Styles</div></div>
          <div class="stat-card"><div class="stat-value" id="stat-colors">0</div><div class="stat-label">Colors</div></div>
          <div class="stat-card"><div class="stat-value" id="stat-patches">0</div><div class="stat-label">Patch Options</div></div>
          <div class="stat-card"><div class="stat-value" id="stat-categories">0</div><div class="stat-label">Categories</div></div>
        </div>
        <div class="alert alert-green"><span>‚úÖ</span> Your catalog is saved. The link below loads the configurator pre-populated with <strong id="embed-supplier-name">your</strong> exact products, colors, and logo options.</div>
        <div class="card">
          <div class="card-header"><div><div class="card-title">üîó Your Unique Configurator Link</div><div class="card-subtitle">Share this URL ‚Äî it loads with your catalog</div></div><button class="copy-btn" onclick="copyLink()">Copy Link</button></div>
          <div class="embed-box" id="direct-link-box">Save your catalog to generate your link</div>
        </div>
        <div class="card">
          <div class="card-header"><div><div class="card-title">üíª Website Button Code</div><div class="card-subtitle">Paste into your site to add a "Configure Your Gear" button</div></div><button class="copy-btn" onclick="copyEmbed()">Copy Code</button></div>
          <div class="embed-box" id="embed-code-box">Save your catalog to generate embed code</div>
        </div>
        <div class="card">
          <div class="card-header"><div class="card-title">üì• Export Catalog</div></div>
          <p style="font-size:0.85rem;color:var(--text2);margin-bottom:1rem;line-height:1.6">Download your full catalog as a JSON file for backup or developer handoff.</p>
          <button class="btn-secondary" onclick="exportCatalog()">Download catalog.json</button>
        </div>
      </div>

    </main>
  </div>
</div>

<div class="toast" id="toast"></div>

<script>
var currentSupplierId = null;
var catalog = {};

var DEFAULT_PRODUCTS = [
  { id:1,  active:true,  category:'Headwear',     name:'Richardson 112',         sku:'R112',  desc:'6-Panel Structured Snapback', strap:true,  rope:false },
  { id:2,  active:true,  category:'Headwear',     name:'Richardson 258',         sku:'R258',  desc:'6-Panel Rope Hat Snapback',   strap:true,  rope:true  },
  { id:3,  active:true,  category:'Headwear',     name:'Richardson 65',          sku:'R65',   desc:'5-Panel Trucker Snapback',    strap:true,  rope:false },
  { id:4,  active:false, category:'Headwear',     name:'Richardson 172',         sku:'R172',  desc:'Fitted Performance Cap',      strap:false, rope:false },
  { id:5,  active:false, category:'Headwear',     name:'Richardson 115',         sku:'R115',  desc:'Washed Chino Twill Dad Hat',  strap:false, rope:false },
  { id:6,  active:true,  category:'Polos',        name:'Classic Pique Polo',     sku:'PL-CL', desc:'Traditional pique weave, tailored fit', strap:false, rope:false },
  { id:7,  active:true,  category:'Polos',        name:'Performance Polo',       sku:'PL-PF', desc:'Moisture-wicking stretch fabric',       strap:false, rope:false },
  { id:8,  active:true,  category:'Quarter Zips', name:'Lightweight Quarter Zip',sku:'QZ-LW', desc:'Midlayer fleece for cool mornings',     strap:false, rope:false },
  { id:9,  active:true,  category:'Belts',        name:'Ribbon Belt',            sku:'BLT-RB',desc:'Classic woven ribbon, adjustable buckle',strap:false,rope:false },
];
var DEFAULT_COLORS = [
  {hex:'#1a3c2b',name:'Forest Green'},{hex:'#c9a84c',name:'Gold'},{hex:'#1a1a2e',name:'Navy'},
  {hex:'#8B1A1A',name:'Cardinal'},{hex:'#e0dcd3',name:'White',border:true},{hex:'#2b2b2b',name:'Charcoal'},
  {hex:'#3a6fa8',name:'Royal Blue'},{hex:'#c0392b',name:'Red'},
];
var DEFAULT_PATCHES = [
  {id:'logo',active:true, icon:'üñºÔ∏è',name:'Custom Logo',    desc:'Embroidered or woven customer logo'},
  {id:'text',active:true, icon:'‚úèÔ∏è',name:'Text Embroidery',desc:'Custom text, initials, or short phrase'},
  {id:'flag',active:true, icon:'üìç',name:'Flag Patch',     desc:'Country or custom flag on side panel'},
  {id:'none',active:true, icon:'‚úï', name:'No Decoration',  desc:'Plain ‚Äî no patch or embroidery'},
];
var DEFAULT_MINIMUMS = {Headwear:12,Polos:24,'Quarter Zips':12,Belts:24,Bags:48,Outerwear:24};

function key(id){ return 'prokit_supplier_'+id; }

function freshCatalog(name,id){
  return {
    supplierId:id,
    brand:{name:name,tagline:'',primaryColor:'#1a3c2b',accentColor:'#c9a84c',logoUrl:''},
    products:JSON.parse(JSON.stringify(DEFAULT_PRODUCTS)),
    colors:JSON.parse(JSON.stringify(DEFAULT_COLORS)),
    patches:JSON.parse(JSON.stringify(DEFAULT_PATCHES)),
    minimums:Object.assign({},DEFAULT_MINIMUMS),
    leadTime:'3-4 weeks',rushTime:'10-14 business days',
    acceptedFiles:'AI, EPS, PDF, PNG (300dpi+)',
    logoNote:'Please submit vector files (AI or EPS) for best embroidery results.',
  };
}

function getAllIds(){
  var ids=[];
  for(var i=0;i<localStorage.length;i++){
    var k=localStorage.key(i);
    if(k&&k.indexOf('prokit_supplier_')===0) ids.push(k.replace('prokit_supplier_',''));
  }
  return ids;
}

function renderExistingSuppliers(){
  var ids=getAllIds();
  var el=document.getElementById('existing-suppliers-list');
  if(!ids.length){el.innerHTML='<div class="no-suppliers">No accounts saved yet ‚Äî create one above.</div>';return;}
  el.innerHTML=ids.map(function(id){
    try{
      var d=JSON.parse(localStorage.getItem(key(id)));
      var name=d&&d.brand&&d.brand.name?d.brand.name:id;
      return '<button class="existing-supplier-btn" onclick="loadSupplier(\''+id+'\')"><div><span class="existing-supplier-name">'+name+'</span><span class="existing-supplier-id">ID: '+id+'</span></div><span class="existing-supplier-arrow">‚Üí</span></button>';
    }catch(e){return '';}
  }).join('');
}

// Live-preview the supplier ID as user types
document.getElementById('login-supplier-id').addEventListener('input', function(){
  var val = this.value.toLowerCase().replace(/[^a-z0-9-]/g,'');
  document.getElementById('login-id-preview').textContent = val || 'yourID';
});

function loginOrCreate(){
  var name=document.getElementById('login-company-name').value.trim();
  var id=document.getElementById('login-supplier-id').value.trim().toLowerCase().replace(/[^a-z0-9-]/g,'');
  if(!name){showToast('Enter your company name');return;}
  if(!id){showToast('Enter a supplier ID');return;}
  var existing=localStorage.getItem(key(id));
  if(existing){loadSupplier(id);}
  else{catalog=freshCatalog(name,id);catalog.brand.name=name;currentSupplierId=id;localStorage.setItem(key(id),JSON.stringify(catalog));enterPortal();}
}

function loadSupplier(id){
  try{catalog=JSON.parse(localStorage.getItem(key(id)));currentSupplierId=id;enterPortal();}
  catch(e){showToast('Error loading supplier');}
}

function goToLogin(){
  document.getElementById('login-screen').style.display='flex';
  document.getElementById('portal').classList.remove('active');
  renderExistingSuppliers();
}

function enterPortal(){
  document.getElementById('login-screen').style.display='none';
  document.getElementById('portal').classList.add('active');
  applyToForm();updateEmbedCodes();updateStats();
  document.getElementById('nav-supplier-name').textContent=catalog.brand.name||currentSupplierId;
  document.getElementById('display-supplier-id').textContent=currentSupplierId;
  document.getElementById('embed-supplier-name').textContent=catalog.brand.name||'your';
}

function saveAll(){
  catalog.brand.name=document.getElementById('brand-name').value.trim();
  catalog.brand.tagline=document.getElementById('brand-tagline').value.trim();
  catalog.brand.primaryColor=document.getElementById('brand-primary-color').value;
  catalog.brand.accentColor=document.getElementById('brand-accent-color').value;
  catalog.brand.logoUrl=document.getElementById('brand-logo-url').value.trim();
  catalog.leadTime=document.getElementById('lead-time').value.trim();
  catalog.rushTime=document.getElementById('rush-time').value.trim();
  catalog.acceptedFiles=document.getElementById('accepted-files').value.trim();
  catalog.logoNote=document.getElementById('logo-note').value.trim();
  catalog.supplierId=currentSupplierId;
  document.querySelectorAll('.minimum-input').forEach(function(inp){catalog.minimums[inp.dataset.product]=parseInt(inp.value)||12;});
  document.querySelectorAll('[data-product-id]').forEach(function(row){
    var id=parseInt(row.dataset.productId);
    var item=catalog.products.find(function(p){return p.id===id;});
    if(!item)return;
    var tog=row.querySelector('.product-toggle input');
    var sku=row.querySelector('.sku-input');
    if(tog)item.active=tog.checked;
    if(sku)item.sku=sku.value;
  });
  localStorage.setItem(key(currentSupplierId),JSON.stringify(catalog));
  document.getElementById('nav-supplier-name').textContent=catalog.brand.name||currentSupplierId;
  document.getElementById('embed-supplier-name').textContent=catalog.brand.name||'your';
  updateEmbedCodes();updateStats();
  showToast('Saved ‚Äî '+(catalog.brand.name||currentSupplierId));
}

function applyToForm(){
  document.getElementById('brand-name').value=catalog.brand.name||'';
  document.getElementById('brand-tagline').value=catalog.brand.tagline||'';
  document.getElementById('brand-primary-color').value=catalog.brand.primaryColor||'#1a3c2b';
  document.getElementById('brand-primary-hex').value=catalog.brand.primaryColor||'#1a3c2b';
  document.getElementById('brand-accent-color').value=catalog.brand.accentColor||'#c9a84c';
  document.getElementById('brand-accent-hex').value=catalog.brand.accentColor||'#c9a84c';
  document.getElementById('brand-logo-url').value=catalog.brand.logoUrl||'';
  document.getElementById('lead-time').value=catalog.leadTime||'3-4 weeks';
  document.getElementById('rush-time').value=catalog.rushTime||'10-14 business days';
  document.getElementById('accepted-files').value=catalog.acceptedFiles||'AI, EPS, PDF, PNG (300dpi+)';
  document.getElementById('logo-note').value=catalog.logoNote||'';
  livePreview();renderProducts();renderPalette();renderPatches();renderMinimums();
}

function switchTab(name){
  document.querySelectorAll('.tab-content').forEach(function(t){t.classList.remove('active');});
  document.getElementById('tab-'+name).classList.add('active');
  document.querySelectorAll('.sidebar-item').forEach(function(s){s.classList.remove('active');});
  var sb=document.getElementById('sb-'+name);if(sb)sb.classList.add('active');
  if(name==='embed'){updateEmbedCodes();updateStats();}
}

function livePreview(){
  document.getElementById('preview-brand-name').textContent=document.getElementById('brand-name').value||'Your Company Name';
  document.getElementById('preview-brand-tagline').textContent=document.getElementById('brand-tagline').value||'Your tagline appears here';
  document.getElementById('preview-primary-dot').style.background=document.getElementById('brand-primary-color').value;
  document.getElementById('preview-accent-dot').style.background=document.getElementById('brand-accent-color').value;
  var logoUrl=document.getElementById('brand-logo-url').value;
  document.getElementById('logo-preview-box').innerHTML=logoUrl?'<img src="'+logoUrl+'" alt="logo" onerror="this.parentElement.innerHTML=\'üè∑Ô∏è\'">':'üè∑Ô∏è';
}

function syncHex(pid,hid){document.getElementById(hid).value=document.getElementById(pid).value;}
function syncPicker(pid,hid){var h=document.getElementById(hid).value;if(/^#[0-9a-fA-F]{6}$/.test(h))document.getElementById(pid).value=h;}

function renderProducts(){
  document.getElementById('product-tbody').innerHTML=catalog.products.map(function(p){
    return '<tr data-product-id="'+p.id+'">'
      +'<td><label class="product-toggle"><input type="checkbox"'+(p.active?' checked':'')+'><div class="toggle-slider"></div></label></td>'
      +'<td><span class="product-tag '+(p.active?'tag-active':'tag-inactive')+'">'+p.category+'</span></td>'
      +'<td style="font-weight:600">'+p.name+'</td>'
      +'<td><input class="sku-input" value="'+(p.sku||'')+'" placeholder="SKU"></td>'
      +'<td style="color:var(--text2);font-size:0.82rem">'+p.desc+'</td>'
      +'<td><button class="btn-danger" onclick="removeProduct('+p.id+')">Remove</button></td>'
      +'</tr>';
  }).join('');
}

function addProduct(){
  var name=document.getElementById('new-product-name').value.trim();
  if(!name){showToast('Enter a style name');return;}
  catalog.products.push({id:Date.now(),active:true,category:document.getElementById('new-product-category').value,name:name,sku:document.getElementById('new-product-sku').value.trim(),desc:document.getElementById('new-product-desc').value.trim(),strap:document.getElementById('new-product-strap').value==='true',rope:false});
  renderProducts();
  document.getElementById('new-product-name').value='';
  document.getElementById('new-product-sku').value='';
  document.getElementById('new-product-desc').value='';
  showToast('Style added!');
}

function removeProduct(id){catalog.products=catalog.products.filter(function(p){return p.id!==id;});renderProducts();}

function renderPalette(){
  document.getElementById('palette-grid').innerHTML=
    catalog.colors.map(function(c,i){
      return '<div class="palette-swatch" style="background:'+c.hex+';'+(c.border?'outline:2px solid #bbb;':'')+'" title="'+c.name+'">'
        +'<div class="swatch-remove" onclick="removeColor('+i+')">√ó</div></div>';
    }).join('')+'<button class="add-color-btn" onclick="openColorModal()">+</button>';
}

function openColorModal(){
  document.getElementById('new-color-name').value='';
  document.getElementById('new-color-hex').value='#1a3c2b';
  document.getElementById('new-color-picker').value='#1a3c2b';
  document.getElementById('color-preview-large').style.background='#1a3c2b';
  document.getElementById('color-modal').classList.add('open');
  document.getElementById('new-color-picker').oninput=function(){
    document.getElementById('new-color-hex').value=this.value;
    document.getElementById('color-preview-large').style.background=this.value;
  };
  document.getElementById('new-color-hex').oninput=function(){
    if(/^#[0-9a-fA-F]{6}$/.test(this.value)){
      document.getElementById('new-color-picker').value=this.value;
      document.getElementById('color-preview-large').style.background=this.value;
    }
  };
}
function closeColorModal(){document.getElementById('color-modal').classList.remove('open');}
function confirmAddColor(){
  var name=document.getElementById('new-color-name').value.trim();
  var hex=document.getElementById('new-color-hex').value.trim();
  if(!name){showToast('Enter a color name');return;}
  if(!/^#[0-9a-fA-F]{6}$/.test(hex)){showToast('Enter a valid hex like #1a3c2b');return;}
  catalog.colors.push({hex:hex,name:name});
  renderPalette();closeColorModal();showToast('Color added!');
}
function removeColor(i){catalog.colors.splice(i,1);renderPalette();}

function renderPatches(){
  document.getElementById('patch-list').innerHTML=catalog.patches.map(function(p,i){
    return '<div class="patch-item">'
      +'<div class="patch-icon-preview">'+p.icon+'</div>'
      +'<div class="patch-info"><div class="patch-name">'+p.name+'</div><div class="patch-desc">'+p.desc+'</div></div>'
      +'<label class="product-toggle"><input type="checkbox"'+(p.active?' checked':'')
      +' onchange="catalog.patches['+i+'].active=this.checked"><div class="toggle-slider"></div></label>'
      +'</div>';
  }).join('');
}

function renderMinimums(){
  var cats=['Headwear','Polos','Quarter Zips','Belts','Bags','Outerwear'];
  document.getElementById('minimums-grid').innerHTML=cats.map(function(cat){
    return '<div class="minimum-card"><div class="minimum-product">'+cat+'</div>'
      +'<input class="minimum-input" type="number" data-product="'+cat+'" value="'+(catalog.minimums[cat]||12)+'" min="1">'
      +'<div class="minimum-unit">units minimum</div></div>';
  }).join('');
}

function updateEmbedCodes(){
  if(!currentSupplierId)return;
  var base=window.location.href.replace('supplier.html','configure.html');
  var link=base+'?supplier='+currentSupplierId;
  var lb=document.getElementById('direct-link-box');
  var eb=document.getElementById('embed-code-box');
  var pl=document.getElementById('nav-preview-link');
  if(lb)lb.textContent=link;
  if(eb)eb.textContent='<a href="'+link+'"\n   target="_blank"\n   style="background:#1a3c2b;color:white;\n          padding:12px 28px;font-family:sans-serif;\n          font-size:14px;font-weight:600;\n          text-decoration:none;border-radius:3px;\n          display:inline-block">\n  Configure Your Gear ‚Üí\n</a>';
  if(pl)pl.href=link;
}

function updateStats(){
  var active=catalog.products?catalog.products.filter(function(p){return p.active;}):[]; 
  var cats=[];active.forEach(function(p){if(cats.indexOf(p.category)===-1)cats.push(p.category);});
  var ap=catalog.patches?catalog.patches.filter(function(p){return p.active;}):[];
  function s(id,v){var el=document.getElementById(id);if(el)el.textContent=v;}
  s('stat-products',active.length);s('stat-colors',catalog.colors?catalog.colors.length:0);
  s('stat-patches',ap.length);s('stat-categories',cats.length);
}

function copyLink(){var b=document.getElementById('direct-link-box');if(b){navigator.clipboard.writeText(b.textContent);showToast('Link copied!');}}
function copyEmbed(){var b=document.getElementById('embed-code-box');if(b){navigator.clipboard.writeText(b.textContent);showToast('Embed code copied!');}}
function exportCatalog(){
  var blob=new Blob([JSON.stringify(catalog,null,2)],{type:'application/json'});
  var a=document.createElement('a');a.href=URL.createObjectURL(blob);
  a.download=(currentSupplierId||'prokit')+'-catalog.json';a.click();
}

function showToast(msg){
  var t=document.getElementById('toast');t.textContent=msg;t.classList.add('show');
  setTimeout(function(){t.classList.remove('show');},3000);
}

// INIT
renderExistingSuppliers();
</script>
</body>
</html>
