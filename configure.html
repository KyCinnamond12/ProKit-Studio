<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Configure Your Gear ‚Äî ProKit Studio</title>
<link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=DM+Sans:wght@300;400;500;600&family=DM+Mono:wght@400;500&display=swap" rel="stylesheet">
<style>
  :root {
    --bg: #111410;
    --bg2: #1a1d16;
    --bg3: #222620;
    --border: #2e332a;
    --gold: #c9a84c;
    --gold-light: #e8c96d;
    --green: #2d6a4f;
    --green-light: #3a8563;
    --white: #f0ece3;
    --muted: #7a7d74;
    --cream: #d6d2c8;
  }

  * { margin: 0; padding: 0; box-sizing: border-box; }
  html { scroll-behavior: smooth; }

  body {
    font-family: 'DM Sans', sans-serif;
    background: var(--bg);
    color: var(--white);
    min-height: 100vh;
    overflow-x: hidden;
  }

  /* NAV */
  nav {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 1.2rem 2.5rem;
    border-bottom: 1px solid var(--border);
    background: var(--bg);
    position: sticky;
    top: 0;
    z-index: 100;
  }

  .logo {
    font-family: 'Bebas Neue', sans-serif;
    font-size: 1.5rem;
    letter-spacing: 0.08em;
    color: var(--white);
    text-decoration: none;
  }

  .logo span { color: var(--gold); }

  .nav-back {
    font-size: 0.82rem;
    font-weight: 500;
    letter-spacing: 0.06em;
    text-transform: uppercase;
    color: var(--muted);
    text-decoration: none;
    display: flex;
    align-items: center;
    gap: 0.5rem;
    transition: color 0.2s;
  }

  .nav-back:hover { color: var(--white); }

  /* LAYOUT */
  .app {
    display: grid;
    grid-template-columns: 380px 1fr;
    height: calc(100vh - 61px);
    overflow: hidden;
  }

  /* LEFT PANEL ‚Äî Steps */
  .steps-panel {
    background: var(--bg2);
    border-right: 1px solid var(--border);
    overflow-y: auto;
    height: 100%;
    padding: 2rem 1.8rem;
  }

  .panel-title {
    font-family: 'DM Mono', monospace;
    font-size: 0.65rem;
    letter-spacing: 0.2em;
    text-transform: uppercase;
    color: var(--muted);
    margin-bottom: 2rem;
  }

  /* STEP BLOCK */
  .step-block {
    margin-bottom: 0.5rem;
    border: 1px solid var(--border);
    border-radius: 4px;
    overflow: hidden;
    transition: border-color 0.3s;
  }

  .step-block.active { border-color: var(--gold); }
  .step-block.completed { border-color: var(--green); }
  .step-block.locked { opacity: 0.4; pointer-events: none; }

  .step-header {
    display: flex;
    align-items: center;
    gap: 1rem;
    padding: 1rem 1.2rem;
    cursor: pointer;
    background: var(--bg3);
    user-select: none;
  }

  .step-num-badge {
    width: 26px;
    height: 26px;
    border-radius: 50%;
    background: var(--border);
    display: flex;
    align-items: center;
    justify-content: center;
    font-family: 'DM Mono', monospace;
    font-size: 0.7rem;
    color: var(--muted);
    flex-shrink: 0;
    transition: all 0.3s;
  }

  .step-block.active .step-num-badge {
    background: var(--gold);
    color: var(--bg);
  }

  .step-block.completed .step-num-badge {
    background: var(--green);
    color: white;
  }

  .step-block.completed .step-num-badge::after {
    content: '‚úì';
  }

  .step-block.completed .step-num-badge-num { display: none; }

  .step-header-text { flex: 1; }

  .step-label {
    font-size: 0.7rem;
    font-family: 'DM Mono', monospace;
    letter-spacing: 0.12em;
    text-transform: uppercase;
    color: var(--muted);
  }

  .step-title {
    font-size: 0.95rem;
    font-weight: 600;
    color: var(--white);
    margin-top: 0.1rem;
  }

  .step-selection {
    font-size: 0.8rem;
    color: var(--gold);
    margin-top: 0.2rem;
    display: none;
  }

  .step-block.completed .step-selection { display: block; }

  .step-chevron {
    color: var(--muted);
    transition: transform 0.3s;
    font-size: 0.8rem;
  }

  .step-block.active .step-chevron { transform: rotate(180deg); color: var(--gold); }

  /* STEP CONTENT */
  .step-content {
    display: none;
    padding: 1.2rem;
    background: var(--bg);
    border-top: 1px solid var(--border);
  }

  .step-block.active .step-content { display: block; }

  /* Product Grid */
  .product-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 0.6rem;
  }

  .product-card {
    border: 1px solid var(--border);
    border-radius: 4px;
    padding: 1rem;
    cursor: pointer;
    text-align: center;
    transition: all 0.2s;
    background: var(--bg2);
  }

  .product-card:hover { border-color: var(--gold); background: var(--bg3); }
  .product-card.selected { border-color: var(--gold); background: rgba(201,168,76,0.08); }

  .product-card.coming-soon {
    opacity: 0.35;
    cursor: not-allowed;
    pointer-events: none;
  }

  .product-icon { font-size: 2rem; margin-bottom: 0.5rem; }

  .product-name {
    font-size: 0.82rem;
    font-weight: 600;
    color: var(--white);
  }

  .product-soon {
    font-size: 0.65rem;
    font-family: 'DM Mono', monospace;
    color: var(--muted);
    margin-top: 0.2rem;
    letter-spacing: 0.1em;
    text-transform: uppercase;
  }

  /* Style Options */
  .style-list {
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
  }

  .style-option {
    border: 1px solid var(--border);
    border-radius: 4px;
    padding: 0.8rem 1rem;
    cursor: pointer;
    background: var(--bg2);
    transition: all 0.2s;
    display: flex;
    align-items: center;
    justify-content: space-between;
  }

  .style-option:hover { border-color: var(--gold); }
  .style-option.selected { border-color: var(--gold); background: rgba(201,168,76,0.08); }

  .style-name {
    font-size: 0.88rem;
    font-weight: 600;
    color: var(--white);
  }

  .style-desc {
    font-size: 0.75rem;
    color: var(--muted);
    margin-top: 0.15rem;
  }

  .style-check {
    width: 18px;
    height: 18px;
    border-radius: 50%;
    border: 2px solid var(--border);
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 0.6rem;
    flex-shrink: 0;
    transition: all 0.2s;
  }

  .style-option.selected .style-check {
    background: var(--gold);
    border-color: var(--gold);
    color: var(--bg);
  }

  /* CUSTOMIZE PANEL (Step 3) */
  .customize-section {
    margin-bottom: 1.5rem;
  }

  .customize-label {
    font-size: 0.7rem;
    font-family: 'DM Mono', monospace;
    letter-spacing: 0.14em;
    text-transform: uppercase;
    color: var(--muted);
    margin-bottom: 0.8rem;
    display: flex;
    align-items: center;
    gap: 0.5rem;
  }

  .customize-label::after {
    content: '';
    flex: 1;
    height: 1px;
    background: var(--border);
  }

  .color-swatches {
    display: flex;
    gap: 0.5rem;
    flex-wrap: wrap;
  }

  .swatch {
    width: 28px;
    height: 28px;
    border-radius: 50%;
    cursor: pointer;
    border: 2px solid transparent;
    transition: transform 0.15s, border-color 0.15s, box-shadow 0.15s;
    position: relative;
  }

  .swatch:hover { transform: scale(1.15); }
  .swatch.active {
    border-color: var(--gold);
    box-shadow: 0 0 0 3px rgba(201,168,76,0.25);
    transform: scale(1.15);
  }

  .swatch[title]:hover::after {
    content: attr(title);
    position: absolute;
    bottom: 130%;
    left: 50%;
    transform: translateX(-50%);
    background: var(--bg3);
    border: 1px solid var(--border);
    color: var(--white);
    font-size: 0.65rem;
    padding: 0.2rem 0.5rem;
    border-radius: 3px;
    white-space: nowrap;
    pointer-events: none;
  }

  .patch-options {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 0.5rem;
  }

  .patch-option {
    border: 1px solid var(--border);
    border-radius: 4px;
    padding: 0.7rem;
    cursor: pointer;
    text-align: center;
    background: var(--bg2);
    transition: all 0.2s;
    font-size: 0.8rem;
    color: var(--white);
  }

  .patch-option:hover { border-color: var(--gold); }
  .patch-option.selected { border-color: var(--gold); background: rgba(201,168,76,0.08); color: var(--gold); }

  .patch-icon { font-size: 1.4rem; display: block; margin-bottom: 0.3rem; }

  /* Proceed Button */
  .proceed-btn {
    width: 100%;
    padding: 0.85rem;
    background: var(--gold);
    color: var(--bg);
    font-size: 0.85rem;
    font-weight: 700;
    letter-spacing: 0.08em;
    text-transform: uppercase;
    border: none;
    border-radius: 4px;
    cursor: pointer;
    margin-top: 1rem;
    transition: background 0.2s, transform 0.15s;
  }

  .proceed-btn:hover { background: var(--gold-light); transform: translateY(-1px); }

  /* Submit button */
  .submit-btn {
    width: 100%;
    padding: 0.85rem;
    background: var(--green);
    color: white;
    font-size: 0.85rem;
    font-weight: 700;
    letter-spacing: 0.08em;
    text-transform: uppercase;
    border: none;
    border-radius: 4px;
    cursor: pointer;
    margin-top: 0.5rem;
    transition: background 0.2s;
  }

  .submit-btn:hover { background: var(--green-light); }

  /* RIGHT PANEL ‚Äî Preview */
  .preview-panel {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    padding: 3rem;
    position: relative;
    background: #ffffff;
    border-left: 1px solid #e0ddd8;
    overflow: hidden;
    height: 100%;
  }

  .preview-label {
    font-family: 'DM Mono', monospace;
    font-size: 0.65rem;
    letter-spacing: 0.2em;
    text-transform: uppercase;
    color: #999;
    margin-bottom: 2rem;
    align-self: flex-start;
  }

  .hat-stage {
    flex: 1;
    display: flex;
    align-items: center;
    justify-content: center;
    width: 100%;
    max-width: 500px;
  }

  #hat-svg {
    width: 100%;
    max-width: 420px;
    filter: drop-shadow(0 20px 40px rgba(0,0,0,0.15));
    transition: all 0.5s ease;
    animation: floatHat 5s ease-in-out infinite;
  }

  @keyframes floatHat {
    0%, 100% { transform: translateY(0px) rotate(-1deg); }
    50% { transform: translateY(-14px) rotate(1.5deg); }
  }

  .preview-meta {
    margin-top: 2.5rem;
    display: flex;
    gap: 1rem;
    flex-wrap: wrap;
    justify-content: center;
    align-self: center;
  }

  .meta-tag {
    background: #f5f5f5;
    border: 1px solid #e0ddd8;
    padding: 0.35rem 0.9rem;
    border-radius: 20px;
    font-size: 0.75rem;
    color: #666;
    font-family: 'DM Mono', monospace;
    letter-spacing: 0.05em;
    transition: all 0.3s;
  }

  .meta-tag.lit {
    border-color: var(--gold);
    color: var(--gold);
    background: rgba(201,168,76,0.08);
  }

  /* Placeholder state */
  .preview-placeholder {
    text-align: center;
    color: #bbb;
  }

  .placeholder-icon {
    font-size: 4rem;
    opacity: 0.3;
    margin-bottom: 1rem;
  }

  .placeholder-text {
    font-size: 0.9rem;
    line-height: 1.6;
  }

  /* Toast */
  .toast {
    position: fixed;
    bottom: 2rem;
    right: 2rem;
    background: var(--green);
    color: white;
    padding: 1rem 1.5rem;
    border-radius: 4px;
    font-size: 0.9rem;
    font-weight: 600;
    transform: translateY(100px);
    opacity: 0;
    transition: all 0.4s ease;
    z-index: 999;
  }

  .toast.show { transform: translateY(0); opacity: 1; }

  /* Step 3 accordion sub-sections */
  .sub-accordion {
    margin-bottom: 0.8rem;
  }

  .sub-accordion-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    cursor: pointer;
    padding: 0.5rem 0;
  }

  .sub-accordion-body {
    padding-top: 0.8rem;
  }

  /* SUMMARY MODAL */
  .modal-overlay {
    position: fixed;
    inset: 0;
    background: rgba(0,0,0,0.6);
    backdrop-filter: blur(4px);
    z-index: 200;
    display: flex;
    align-items: center;
    justify-content: center;
    opacity: 0;
    pointer-events: none;
    transition: opacity 0.3s;
  }

  .modal-overlay.open {
    opacity: 1;
    pointer-events: all;
  }

  .modal {
    background: #1a1d16;
    border: 1px solid #2e332a;
    border-radius: 6px;
    width: 90%;
    max-width: 520px;
    padding: 2.5rem;
    transform: translateY(20px);
    transition: transform 0.3s;
  }

  .modal-overlay.open .modal {
    transform: translateY(0);
  }

  .modal-title {
    font-family: 'Bebas Neue', sans-serif;
    font-size: 2rem;
    color: #f0ece3;
    letter-spacing: 0.05em;
    margin-bottom: 0.3rem;
  }

  .modal-subtitle {
    font-size: 0.82rem;
    color: #7a7d74;
    margin-bottom: 2rem;
    font-family: 'DM Mono', monospace;
    letter-spacing: 0.08em;
    text-transform: uppercase;
  }

  .summary-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 1px;
    background: #2e332a;
    border: 1px solid #2e332a;
    border-radius: 4px;
    overflow: hidden;
    margin-bottom: 2rem;
  }

  .summary-item {
    background: #111410;
    padding: 1rem 1.2rem;
  }

  .summary-item-label {
    font-size: 0.65rem;
    font-family: 'DM Mono', monospace;
    letter-spacing: 0.15em;
    text-transform: uppercase;
    color: #7a7d74;
    margin-bottom: 0.4rem;
  }

  .summary-item-value {
    font-size: 0.92rem;
    font-weight: 600;
    color: #f0ece3;
    display: flex;
    align-items: center;
    gap: 0.5rem;
  }

  .summary-color-dot {
    width: 14px;
    height: 14px;
    border-radius: 50%;
    border: 1px solid rgba(255,255,255,0.15);
    flex-shrink: 0;
  }

  .modal-actions {
    display: flex;
    gap: 0.8rem;
  }

  .modal-confirm {
    flex: 1;
    padding: 0.9rem;
    background: #2d6a4f;
    color: white;
    font-size: 0.85rem;
    font-weight: 700;
    letter-spacing: 0.08em;
    text-transform: uppercase;
    border: none;
    border-radius: 4px;
    cursor: pointer;
    transition: background 0.2s;
  }

  .modal-confirm:hover { background: #3a8563; }

  .modal-cancel {
    padding: 0.9rem 1.5rem;
    background: transparent;
    color: #7a7d74;
    font-size: 0.85rem;
    font-weight: 600;
    border: 1px solid #2e332a;
    border-radius: 4px;
    cursor: pointer;
    transition: color 0.2s;
  }

  .modal-cancel:hover { color: #f0ece3; }

</style>
</head>
<body>

<!-- NAV -->
<nav>
  <a href="index.html" class="logo">ProKit<span>Studio</span></a>
  <a href="index.html" class="nav-back">‚Üê Back to Home</a>
</nav>

<!-- APP LAYOUT -->
<div class="app">

  <!-- LEFT: STEPS PANEL -->
  <div class="steps-panel">
    <p class="panel-title">Configuration Wizard</p>

    <!-- STEP 1: Product Category -->
    <div class="step-block active" id="step1">
      <div class="step-header" onclick="toggleStep(1)">
        <div class="step-num-badge"><span class="step-num-badge-num">1</span></div>
        <div class="step-header-text">
          <div class="step-label">Step 1</div>
          <div class="step-title">Choose Your Product</div>
          <div class="step-selection" id="step1-selection"></div>
        </div>
        <div class="step-chevron">‚ñº</div>
      </div>
      <div class="step-content">
        <div class="product-grid">
          <div class="product-card" onclick="selectProduct(this, 'Headwear', 'üß¢')">
            <div class="product-icon">üß¢</div>
            <div class="product-name">Headwear</div>
          </div>
          <div class="product-card coming-soon" onclick="">
            <div class="product-icon">üëî</div>
            <div class="product-name">Shirts</div>
            <div class="product-soon">Coming Soon</div>
          </div>
          <div class="product-card coming-soon">
            <div class="product-icon">ü©≥</div>
            <div class="product-name">Bottoms</div>
            <div class="product-soon">Coming Soon</div>
          </div>
          <div class="product-card coming-soon">
            <div class="product-icon">üéΩ</div>
            <div class="product-name">Outerwear</div>
            <div class="product-soon">Coming Soon</div>
          </div>
          <div class="product-card coming-soon">
            <div class="product-icon">üëú</div>
            <div class="product-name">Bags</div>
            <div class="product-soon">Coming Soon</div>
          </div>
          <div class="product-card coming-soon">
            <div class="product-icon">ü™£</div>
            <div class="product-name">Belts</div>
            <div class="product-soon">Coming Soon</div>
          </div>
        </div>
      </div>
    </div>

    <!-- STEP 2: Product Style -->
    <div class="step-block locked" id="step2">
      <div class="step-header" onclick="toggleStep(2)">
        <div class="step-num-badge"><span class="step-num-badge-num">2</span></div>
        <div class="step-header-text">
          <div class="step-label">Step 2</div>
          <div class="step-title">Choose Your Style</div>
          <div class="step-selection" id="step2-selection"></div>
        </div>
        <div class="step-chevron">‚ñº</div>
      </div>
      <div class="step-content">
        <div class="style-list" id="style-list">
          <!-- Populated by JS -->
        </div>
      </div>
    </div>

    <!-- STEP 3: Customize -->
    <div class="step-block locked" id="step3">
      <div class="step-header" onclick="toggleStep(3)">
        <div class="step-num-badge"><span class="step-num-badge-num">3</span></div>
        <div class="step-header-text">
          <div class="step-label">Step 3</div>
          <div class="step-title">Customize Your Gear</div>
        </div>
        <div class="step-chevron">‚ñº</div>
      </div>
      <div class="step-content">

        <!-- Crown Color -->
        <div class="customize-section">
          <div class="customize-label">Crown Color</div>
          <div class="color-swatches" id="crown-swatches">
            <div class="swatch active" style="background:#1a3c2b" onclick="setColor(this,'crown','#1a3c2b')" title="Forest Green"></div>
            <div class="swatch" style="background:#c9a84c" onclick="setColor(this,'crown','#c9a84c')" title="Gold"></div>
            <div class="swatch" style="background:#1a1a2e" onclick="setColor(this,'crown','#1a1a2e')" title="Navy"></div>
            <div class="swatch" style="background:#8B1A1A" onclick="setColor(this,'crown','#8B1A1A')" title="Cardinal"></div>
            <div class="swatch" style="background:#f0ece3; border:1px solid #555" onclick="setColor(this,'crown','#e0dcd3')" title="White"></div>
            <div class="swatch" style="background:#2b2b2b" onclick="setColor(this,'crown','#2b2b2b')" title="Charcoal"></div>
            <div class="swatch" style="background:#5c3d1e" onclick="setColor(this,'crown','#5c3d1e')" title="Brown"></div>
            <div class="swatch" style="background:#7a4f7d" onclick="setColor(this,'crown','#7a4f7d')" title="Purple"></div>
          </div>
        </div>

        <!-- Brim Color -->
        <div class="customize-section">
          <div class="customize-label">Brim Color</div>
          <div class="color-swatches" id="brim-swatches">
            <div class="swatch active" style="background:#c9a84c" onclick="setColor(this,'brim','#c9a84c')" title="Gold"></div>
            <div class="swatch" style="background:#1a3c2b" onclick="setColor(this,'brim','#1a3c2b')" title="Forest Green"></div>
            <div class="swatch" style="background:#2b2b2b" onclick="setColor(this,'brim','#2b2b2b')" title="Black"></div>
            <div class="swatch" style="background:#f0ece3; border:1px solid #555" onclick="setColor(this,'brim','#e0dcd3')" title="White"></div>
            <div class="swatch" style="background:#1a1a2e" onclick="setColor(this,'brim','#1a1a2e')" title="Navy"></div>
            <div class="swatch" style="background:#8B1A1A" onclick="setColor(this,'brim','#8B1A1A')" title="Cardinal"></div>
          </div>
        </div>

        <!-- Eyelet/Stitch Color -->
        <div class="customize-section">
          <div class="customize-label">Stitch & Eyelet Color</div>
          <div class="color-swatches" id="stitch-swatches">
            <div class="swatch active" style="background:#c9a84c" onclick="setColor(this,'stitch','#c9a84c')" title="Gold"></div>
            <div class="swatch" style="background:#f0ece3; border:1px solid #555" onclick="setColor(this,'stitch','#f0ece3')" title="White"></div>
            <div class="swatch" style="background:#2b2b2b" onclick="setColor(this,'stitch','#2b2b2b')" title="Black"></div>
            <div class="swatch" style="background:#1a3c2b" onclick="setColor(this,'stitch','#1a3c2b')" title="Forest Green"></div>
          </div>
        </div>

        <!-- Patch / Logo -->
        <div class="customize-section">
          <div class="customize-label">Logo / Patch</div>
          <div class="patch-options">
            <div class="patch-option selected" onclick="setPatch(this,'logo')">
              <span class="patch-icon">üñºÔ∏è</span>
              Custom Logo
            </div>
            <div class="patch-option" onclick="setPatch(this,'text')">
              <span class="patch-icon">‚úèÔ∏è</span>
              Text Only
            </div>
            <div class="patch-option" onclick="setPatch(this,'flag')">
              <span class="patch-icon">üìç</span>
              Flag Patch
            </div>
            <div class="patch-option" onclick="setPatch(this,'none')">
              <span class="patch-icon">‚úï</span>
              No Patch
            </div>
          </div>
        </div>

        <!-- Patch Color -->
        <div class="customize-section" id="patch-color-section">
          <div class="customize-label">Patch Color</div>
          <div class="color-swatches" id="patch-swatches">
            <div class="swatch active" style="background:#1a3c2b" onclick="setColor(this,'patch','#1a3c2b')" title="Forest Green"></div>
            <div class="swatch" style="background:#c9a84c" onclick="setColor(this,'patch','#c9a84c')" title="Gold"></div>
            <div class="swatch" style="background:#1a1a2e" onclick="setColor(this,'patch','#1a1a2e')" title="Navy"></div>
            <div class="swatch" style="background:#2b2b2b" onclick="setColor(this,'patch','#2b2b2b')" title="Black"></div>
            <div class="swatch" style="background:#f0ece3; border:1px solid #555" onclick="setColor(this,'patch','#f0ece3')" title="White"></div>
          </div>
        </div>

        <button class="submit-btn" onclick="submitConfig()">Submit for Production ‚Üí</button>
        <button class="proceed-btn" style="background:transparent; border:1px solid var(--border); color:var(--muted); margin-top:0.5rem" onclick="saveDraft()">Save Draft</button>

      </div>
    </div>

  </div>

  <!-- RIGHT: PREVIEW PANEL -->
  <div class="preview-panel">
    <p class="preview-label">Live Preview</p>

    <div class="hat-stage" id="hat-stage">
      <!-- Placeholder before product is chosen -->
      <div class="preview-placeholder" id="preview-placeholder">
        <div class="placeholder-icon">üß¢</div>
        <p class="placeholder-text">Select a product and style<br>to see your live preview</p>
      </div>

      <!-- Hat SVG (hidden until step 2 complete) -->
      <svg id="hat-svg" style="display:none" viewBox="0 0 400 360" fill="none" xmlns="http://www.w3.org/2000/svg">
        <!-- Shadow -->
        <ellipse cx="200" cy="318" rx="160" ry="22" fill="rgba(0,0,0,0.35)"/>
        <!-- Crown -->
        <path id="svg-crown" d="M80 280 Q72 190 100 135 Q145 68 200 62 Q255 68 300 135 Q328 190 320 280 Z" fill="#1a3c2b"/>
        <!-- Panel seams -->
        <path d="M200 62 Q215 140 220 280" stroke="rgba(0,0,0,0.12)" stroke-width="1.5" stroke-dasharray="none"/>
        <path d="M200 62 Q185 140 180 280" stroke="rgba(0,0,0,0.12)" stroke-width="1.5"/>
        <path d="M200 62 Q250 115 295 175" stroke="rgba(0,0,0,0.08)" stroke-width="1"/>
        <path d="M200 62 Q150 115 105 175" stroke="rgba(0,0,0,0.08)" stroke-width="1"/>
        <!-- Sweatband -->
        <rect x="82" y="262" width="236" height="14" rx="2" fill="rgba(0,0,0,0.25)"/>
        <!-- Brim underside -->
        <path id="svg-brim-under" d="M80 280 Q74 262 92 254 L308 254 Q326 262 320 280 Z" fill="#a8883a"/>
        <!-- Brim top -->
        <path id="svg-brim" d="M80 280 Q74 264 100 258 L300 258 Q326 264 320 280 Z" fill="#c9a84c"/>
        <!-- Eyelets -->
        <circle id="svg-eyelet1" cx="258" cy="175" r="4" fill="rgba(201,168,76,0.7)"/>
        <circle id="svg-eyelet2" cx="142" cy="175" r="4" fill="rgba(201,168,76,0.7)"/>
        <!-- Patch area -->
        <g id="svg-patch" style="transition: opacity 0.3s">
          <rect id="svg-patch-bg" x="152" y="155" width="96" height="68" rx="5" fill="rgba(26,60,43,0.92)"/>
          <text id="svg-patch-text" x="200" y="195" text-anchor="middle" fill="#c9a84c" font-size="13" font-family="Arial" font-weight="bold" letter-spacing="1">YOUR LOGO</text>
          <text id="svg-patch-sub" x="200" y="211" text-anchor="middle" fill="rgba(201,168,76,0.5)" font-size="8" font-family="Arial" letter-spacing="2">EST. 2025</text>
        </g>
        <!-- Button top -->
        <circle id="svg-button" cx="200" cy="68" r="10" fill="rgba(0,0,0,0.35)"/>
        <!-- Snapback strap (only for snapback) -->
        <g id="svg-strap">
          <rect x="170" y="278" width="60" height="14" rx="3" fill="#111" opacity="0.7"/>
          <rect x="188" y="282" width="24" height="6" rx="1" fill="#333" opacity="0.8"/>
          <circle cx="212" cy="285" r="2" fill="#555"/>
          <circle cx="207" cy="285" r="2" fill="#555"/>
          <circle cx="202" cy="285" r="2" fill="#555"/>
        </g>
      </svg>
    </div>

    <!-- Meta tags -->
    <div class="preview-meta" id="preview-meta">
      <span class="meta-tag" id="tag-product">No product selected</span>
      <span class="meta-tag" id="tag-style">No style selected</span>
      <span class="meta-tag" id="tag-crown">Crown: ‚Äî</span>
      <span class="meta-tag" id="tag-brim">Brim: ‚Äî</span>
      <span class="meta-tag" id="tag-patch">Patch: ‚Äî</span>
    </div>
  </div>

</div>

<!-- Toast notification -->
<div class="toast" id="toast"></div>

<script>
  // State
  const state = {
    product: null,
    style: null,
    crownColor: '#1a3c2b',
    brimColor: '#c9a84c',
    stitchColor: '#c9a84c',
    patchColor: '#1a3c2b',
    patch: 'logo',
    crownName: 'Forest Green',
    brimName: 'Gold',
    patchName: 'Custom Logo'
  };

  const stylesByProduct = {
    Headwear: [
      { name: 'Richardson 112', desc: '6-Panel Structured Snapback', strap: true },
      { name: 'Richardson 65', desc: '5-Panel Trucker Snapback', strap: true },
      { name: 'Richardson 172', desc: 'Fitted Performance Cap', strap: false },
      { name: 'Richardson 115', desc: 'Washed Chino Twill Dad Hat', strap: false },
    ]
  };

  // Toggle step open/close
  function toggleStep(num) {
    const block = document.getElementById('step' + num);
    if (block.classList.contains('locked')) return;
    const isActive = block.classList.contains('active');
    // Close all
    [1,2,3].forEach(n => {
      const b = document.getElementById('step' + n);
      if (!b.classList.contains('locked')) b.classList.remove('active');
    });
    if (!isActive) block.classList.add('active');
  }

  // Step 1: Select product
  function selectProduct(el, name, icon) {
    document.querySelectorAll('.product-card').forEach(c => c.classList.remove('selected'));
    el.classList.add('selected');
    state.product = name;

    // Update selection display
    document.getElementById('step1-selection').textContent = icon + ' ' + name;

    // Populate style list
    const styles = stylesByProduct[name] || [];
    const list = document.getElementById('style-list');
    list.innerHTML = styles.map((s, i) => `
      <div class="style-option" onclick="selectStyle(this, '${s.name}', ${s.strap})">
        <div>
          <div class="style-name">${s.name}</div>
          <div class="style-desc">${s.desc}</div>
        </div>
        <div class="style-check">‚úì</div>
      </div>
    `).join('');

    // Advance
    setTimeout(() => {
      document.getElementById('step1').classList.remove('active');
      document.getElementById('step1').classList.add('completed');
      document.getElementById('step2').classList.remove('locked');
      document.getElementById('step2').classList.add('active');
    }, 300);

    updateTag('tag-product', name, true);
  }

  // Step 2: Select style
  function selectStyle(el, name, hasStrap) {
    document.querySelectorAll('.style-option').forEach(o => o.classList.remove('selected'));
    el.classList.add('selected');
    state.style = name;

    document.getElementById('step2-selection').textContent = name;

    // Show/hide strap
    document.getElementById('svg-strap').style.display = hasStrap ? 'block' : 'none';

    // Show hat
    document.getElementById('preview-placeholder').style.display = 'none';
    document.getElementById('hat-svg').style.display = 'block';

    setTimeout(() => {
      document.getElementById('step2').classList.remove('active');
      document.getElementById('step2').classList.add('completed');
      document.getElementById('step3').classList.remove('locked');
      document.getElementById('step3').classList.add('active');
    }, 300);

    updateTag('tag-style', name, true);
    updateTag('tag-crown', 'Crown: Forest Green', true);
    updateTag('tag-brim', 'Brim: Gold', true);
    updateTag('tag-patch', 'Patch: Custom Logo', true);
  }

  // Set color
  function setColor(el, part, color) {
    const group = el.parentElement;
    group.querySelectorAll('.swatch').forEach(s => s.classList.remove('active'));
    el.classList.add('active');
    const name = el.getAttribute('title');

    if (part === 'crown') {
      state.crownColor = color;
      state.crownName = name;
      document.getElementById('svg-crown').setAttribute('fill', color);
      document.getElementById('svg-button').setAttribute('fill', shadeColor(color, -30));
      updateTag('tag-crown', 'Crown: ' + name, true);
    } else if (part === 'brim') {
      state.brimColor = color;
      state.brimName = name;
      document.getElementById('svg-brim').setAttribute('fill', color);
      document.getElementById('svg-brim-under').setAttribute('fill', shadeColor(color, -20));
      updateTag('tag-brim', 'Brim: ' + name, true);
    } else if (part === 'stitch') {
      state.stitchColor = color;
      state.stitchName = name;
      document.getElementById('svg-eyelet1').setAttribute('fill', color + 'cc');
      document.getElementById('svg-eyelet2').setAttribute('fill', color + 'cc');
    } else if (part === 'patch') {
      state.patchColor = color;
      document.getElementById('svg-patch-bg').setAttribute('fill', color);
      // auto-contrast text
      document.getElementById('svg-patch-text').setAttribute('fill', isLight(color) ? '#1a1a1a' : '#c9a84c');
    }
  }

  // Set patch type
  function setPatch(el, type) {
    document.querySelectorAll('.patch-option').forEach(o => o.classList.remove('selected'));
    el.classList.add('selected');
    state.patch = type;

    const patch = document.getElementById('svg-patch');
    const patchText = document.getElementById('svg-patch-text');
    const patchSub = document.getElementById('svg-patch-sub');
    const patchBg = document.getElementById('svg-patch-bg');
    const patchColorSection = document.getElementById('patch-color-section');

    if (type === 'none') {
      patch.style.opacity = '0';
      patch.style.pointerEvents = 'none';
      patchColorSection.style.display = 'none';
      updateTag('tag-patch', 'Patch: None', true);
    } else if (type === 'logo') {
      patch.style.opacity = '1';
      patch.style.pointerEvents = '';
      patchText.textContent = 'YOUR LOGO';
      patchSub.textContent = 'EST. 2025';
      patchColorSection.style.display = '';
      updateTag('tag-patch', 'Patch: Custom Logo', true);
    } else if (type === 'text') {
      patch.style.opacity = '1';
      patch.style.pointerEvents = '';
      patchText.textContent = 'APPO GC';
      patchSub.textContent = 'GOLF CLUB';
      patchColorSection.style.display = '';
      updateTag('tag-patch', 'Patch: Text', true);
    } else if (type === 'flag') {
      patch.style.opacity = '1';
      patch.style.pointerEvents = '';
      patchText.textContent = '‚õ≥ FLAG';
      patchSub.textContent = 'PATCH';
      patchColorSection.style.display = '';
      updateTag('tag-patch', 'Patch: Flag', true);
    }
  }

  function updateTag(id, text, lit) {
    const tag = document.getElementById(id);
    tag.textContent = text;
    if (lit) tag.classList.add('lit');
  }

  function submitConfig() {
    if (!state.style) { showToast('Please complete all steps first!'); return; }
    // Populate summary
    document.getElementById('sum-product').textContent = state.product || '‚Äî';
    document.getElementById('sum-style').textContent = state.style || '‚Äî';
    document.getElementById('sum-crown').textContent = state.crownName || '‚Äî';
    document.getElementById('sum-crown-dot').style.background = state.crownColor;
    document.getElementById('sum-brim').textContent = state.brimName || '‚Äî';
    document.getElementById('sum-brim-dot').style.background = state.brimColor;
    document.getElementById('sum-stitch').textContent = state.stitchName || '‚Äî';
    document.getElementById('sum-stitch-dot').style.background = state.stitchColor;
    const patchLabels = { logo: 'Custom Logo Upload', text: 'Text Embroidery', flag: 'Flag Patch', none: 'No Patch' };
    document.getElementById('sum-patch').textContent = patchLabels[state.patch] || '‚Äî';
    document.getElementById('modal-overlay').classList.add('open');
  }

  function closeModal() {
    document.getElementById('modal-overlay').classList.remove('open');
  }

  function confirmSubmit() {
    closeModal();
    showToast('‚úì Configuration submitted! Your rep will be in touch shortly.');
  }

  function saveDraft() {
    showToast('Draft saved successfully.');
  }

  function showToast(msg) {
    const toast = document.getElementById('toast');
    toast.textContent = msg;
    toast.classList.add('show');
    setTimeout(() => toast.classList.remove('show'), 3500);
  }

  // Utility: darken/lighten a hex color
  function shadeColor(color, percent) {
    const num = parseInt(color.replace('#',''), 16);
    const amt = Math.round(2.55 * percent);
    const R = Math.min(255, Math.max(0, (num >> 16) + amt));
    const G = Math.min(255, Math.max(0, (num >> 8 & 0x00FF) + amt));
    const B = Math.min(255, Math.max(0, (num & 0x0000FF) + amt));
    return '#' + (0x1000000 + R*0x10000 + G*0x100 + B).toString(16).slice(1);
  }

  function isLight(color) {
    const num = parseInt(color.replace('#',''), 16);
    const r = num >> 16, g = num >> 8 & 0xFF, b = num & 0xFF;
    return (r*299 + g*587 + b*114) / 1000 > 128;
  }
</script>

<!-- SUMMARY MODAL -->
<div class="modal-overlay" id="modal-overlay">
  <div class="modal">
    <div class="modal-title">Order Summary</div>
    <div class="modal-subtitle">Review your configuration before submitting</div>
    <div class="summary-grid">
      <div class="summary-item">
        <div class="summary-item-label">Product</div>
        <div class="summary-item-value" id="sum-product">‚Äî</div>
      </div>
      <div class="summary-item">
        <div class="summary-item-label">Style</div>
        <div class="summary-item-value" id="sum-style">‚Äî</div>
      </div>
      <div class="summary-item">
        <div class="summary-item-label">Crown Color</div>
        <div class="summary-item-value"><div class="summary-color-dot" id="sum-crown-dot"></div><span id="sum-crown">‚Äî</span></div>
      </div>
      <div class="summary-item">
        <div class="summary-item-label">Brim Color</div>
        <div class="summary-item-value"><div class="summary-color-dot" id="sum-brim-dot"></div><span id="sum-brim">‚Äî</span></div>
      </div>
      <div class="summary-item">
        <div class="summary-item-label">Patch / Logo</div>
        <div class="summary-item-value" id="sum-patch">‚Äî</div>
      </div>
      <div class="summary-item">
        <div class="summary-item-label">Stitch Color</div>
        <div class="summary-item-value"><div class="summary-color-dot" id="sum-stitch-dot"></div><span id="sum-stitch">‚Äî</span></div>
      </div>
    </div>
    <div class="modal-actions">
      <button class="modal-cancel" onclick="closeModal()">‚Üê Go Back</button>
      <button class="modal-confirm" onclick="confirmSubmit()">Confirm & Submit ‚Üí</button>
    </div>
  </div>
</div>

</body>
</html>
